Taming Terrain - Sculpting geoscapes from LiDAR by Andrew Godwin
I'm happy to introduce Andrew Godwin telling us about LiDAR and terrain mapping. [Applause]. 
>> Thank you. Good evening, everybody. I'm Andrew. My day job is to do boring things with Python and the web but my hobbies are far more interesting, varied, and take too much time. This is a talk about modelling terrain, in particular, making small different models of different parts of the world. One of my first projects was this:  I apologise, this is like a weird low-res thing with a screen but imagine it looks prettier. These are small metal milled national parks of the US. I moved to America four years ago. One of my goals was I want to see every one of the national parks. There are 59 of them and I wanted to do a thing to commemorate them. I then got more ambitious. I got a 3D printer, and bought a second one because you can't just have one of them. I ended up printing these giant city maps. Now, these, the one you see is San Francisco, and there's one of London too - a picture later on - but they're about a metre long, 30 or 40 centimetres high, made up of individual tiles. I bought one here. See me afterwards for various props I have here. Finally, something else I've made recently is inspired by a very famous particular album cover, taking sort of different terrains and doing laser-cut versions of they did. You can see it in person if you like. This talk is about how to go about this kind of stuff. What - with of is the data coming from, and how do you process it and turn into the artefacts here. Let's start with the data. Geodata is an interesting thing. It's a big industry in itself. The thing we want here is elevation data - that is how tall the terrain is. It's generally called a "digital elevation model". None of these terms are accurate or precise. It's a weird disagreement in the industry about them, but generally, you have what is called a digital surface model which includes buildings and things like that, or you have a terrain model which re moves buildings and trees and you have a surface of the air. People who do research on flood plains, things on urban environments want the surface model. You want to have those buildings there. When you have an elevation model in your head, it looks like this. It's a sort of lovely set of information data but this is just a rendering. This has hill shading which lets you see the valleys and shading. Raw elevation data looks more like this. This is the raw data for the big island much Hawaii which is the source for the thing I showed you here. It's not presentable in its exact form but it's a load of data. There's X-Y grid. Each point has an elevation. But of course, this is all well and good, and it's not very nice like that - we will get to the nice bits later - but how do you get this? With this wonderful 2,000-era image, we can see that the Space Shuttle in February of 2000, I believe it was did the Shuttle Rae car Topography Mission. It had two radar an ten crass, one on the shuttle itself, the one next to the 60-metre cable, and they used radar to map the surface of the earth. It projected pulses down and used radar deflection to get the elevation data. This gave us an overview of the earth's elevation. Issues of radar in general, radar is pretty low resolution. It is great for large-scale long-distance stuff, but it's not very good for fine detail. It's fantastic for you're a Space Shuttle and you want to see the earth. It's not so great for I'm a car and I want to see what is in front and he. It needs large an tennias. Up need that 60-metre separation on the Space Shuttle. It is not practical al at low level. LiDAR is like radar but with light. It's an inventive acronym. You send a laser beam at your target, receive it back again, and you measure how long the radar beam took to go to your target. You put that laser on a thing that spins fast and you have a thing that scans the world around it at fast pace. You see it on software and cars, often on the bottom of planes. In general what they use LiDAR for is more close in-mapping, mapping much city scale, or individual terrain scale. So, for example, this here is an excerpt from a  an aerial LiDAR survey of the San Francisco Bay Area. They took a plane, a LiDAR pod underneath it, and it scans the ground below it as you go been gets all this detailed information, and, with that, you can build up an accurate model down to often 50-centimetre accuracy of the place below you. In the raw data here, you can see the individual crossings, and the individual parts of streets in the data. This is the low-resolution version. You can of course do it not just from the air. Here, at the site itself, there was a wonderful LiDAR scan done of the campsite before everyone arrived a few weeks ago. So, this is from a van which has - and a few cameras, and it's really versatile technology. You can map things at different scales, you can literally just map one or two walls or the interior of a room as well. And the nice things about LiDAR is that it's very high resolution, and you can get down to centimetre or sometimes of the new stuff, even millimetre-level accuracy. The devices are very compact, the standard LiDAR scan is around this big. All the laser ifraometry stuff is smaller than radar. It works in short distances. Light in general aten waits over long distances but you're only doing it from a maximum of a few kilometres away, and it's probably not that far. In general, for most things apart from orbital missions, it works pretty well. One of the nice things about LiDAR in general is that even though it's expensive to do, a lot of free data's available from different governmental departments. In particular, our very own environmental agency in other parts of the UK government have free data available. The Environment Agency basically mapped most of the flood plains and coastal areas in the UK with free LiDAR, and I believe there's an ongoing project to map a lot of the rest of the country in LiDAR for free as well. Over in the US, the US geological survey mapped most of America in low resolution, and flood plains in high resolution. It's often used for flood analysis which is why you see it near cities and rivers and things. We have this data. What do we do with it? The problem with LiDAR is that it's not a nice simple elevation model, like I showed you earlier. What you get back from LiDAR is a thing called a point cloud. A point cloud is literally a load of points individually in space with no link to each other. You might get what colour they are. You might get what sort of intensity the laser bones off of them but there's no link. If you zoom in, you go through this swarm of points. There's no solidity to them at all. You can't work out what the surface is. So we have to take this point cloud and turn it into something we can actually use. We feed this to a 3D printer or milling machine, it's not going to do anything. These are dimensionless points in space. They have no material being. And so, that's one of the problems. But the other problem is it's also not pure data. LiDAR, when you get it back, there are a couple of things extra. When the laser hits something, it might hit more than one thing. You get what is called multiple returns, so you may, in fact, get a point of series diminishing points behind each other. If you're flying over something, you, in fact, may get several different features below you in the same vertical space. If you're trying to make an elevation map, you might get there's a top of a building, but also we went through the glass to the floor below it and got a weak return from that, or we can see through trees and things like that, too. Also, it's noisy. Water and steel and water are especially bad. If you go anywhere near like a power plant, something hot, one of my favourite examples recent is I was looking at Didcot, and it's pretty well mapped apart from over the power plant, there's a giant mess as it starts going near all the giant steam emissions. A quick example here. This is the sea off San Francisco again. Random spikes in the middle of the sea. There are no random spikes in the Pacific ocean. I've checked myself. But the LiDAR occasionally bounces off a wave, and thinks there's a spike there. You have to get rid of that stuff. In general, we have to do more than that. We have to take our point cloud. We have to thin it. Take the point cloud and go, "Well, there's individual data here to much higher accuracy than I need. I'm not printing a tree in this side but a zoomed-out model." We have to take those points and reduce the resolution. Often, what I will do, if I'm doing a surface model, say for each small ten-centimetre grid, find the highest point and give me that. That way, you can thin it out to a nice grid. You have to take points and turn them into an elevation model. Often, this is as easy as looking in the grid square, writing it into a file. These two steps can be done with a variety of pieces of software. None are entirely free. I use what is called Laz Tools which is free for small amounts of data, and evaluation use, but if you are using it commercially, you pay a licensing fee. If you're lucky and your department is good, and this includes the UK government who are good at this, they will ship you ready-made DEMs from the LiDAR data so you can skip the first two steps. You can have smoother results. This is conwith, in my case, in special code, sort of tries to average out the different stuff but you have different techniques here. You can try clipping, you can try reducing stuff, and one problem I had was when I got data back from a LiDAR scan of London, it was when Crossrail was being dug initially about 2014, or so, and the data was there are loads of points below sea-level. It had seen the giant pit they put the TVMs in, so rather than print a model with a big hole in it, I had to tell it to smooth it and bring it up to sea-level. Nothing should be below sea-level. We will ignore the giant hole in the ground for now. So, that's kind of the easy part. Faking the data, getting the data. It's not easy. I'm being a little bit over zealous here. But we have JS tools, ways to do this. There are tutorials online. If you want to find elevation data for a part of the Wolds, you're at least going to have a rough resolution of data. You might get mountain level rather than city level. But then we come to fabrication. Now, one of the things I was maybe a little bit too, shall we say, over zealous about initially was, "It'll be really easy to make these. How hard can it be?" Let's go through the three basic techniques here:  3D printing, way makes the city models, like these tiles here, the laser cutting which makes the waive-like shapes, like this one here, and milling, which is what makes the small metallic shapes as well. So let's start with 3D printing. 3D printing is it, thankfully, these days pretty cheap, quite accessible for a lot of people, and quite easy to get stuff into. The basic requirement is you have a 3D model. That's kind of it. Once you've got a good 3D model, the slicer will take care of the rest, give you a tool path and the printer will do the work for you. The basic thing is to take that data and turn it into a 3D model. This was achieved through a wonderful Python script, open source - links at the end. It turns it into 15 centimetre by 15-centimetre models as STL files. This data is on the order of 25 to 50 megabytes per tile. Some 3D printers do not like this, and they will just sit there and complain for about ten minutes and fail. Those are options for making it less and less detailed so it fits in the printer. In my case, I took these big tiles, I put them on one of my 3D printers at home, this is a Setus Mark 3 and left it to print. They are fully automated. The problem is this is a detailed model. There's a lot of fine detail, tiny buildings, print a little bit, travel over, print over again, and keep doing that. This means the tile of this size, which is about this big, is between four and 12 hours continuous printing. You put it on, and go to bed, wake up in the morning, if hope you don't find a big spaghetti mess of plastic in the morning which unfortunately has happened sometimes! Then the problem is you're printing tiles. You've got to assemble those tiles into a bigger whole. Ideally, that looks like this, but this is after hours and hours of meticulous work sanding the side of the tiles down, making sure they are perfectly square, aligning them and trying to glue them perfectly. In the end, it works out pretty well. If you look closely, you can see the seams between the different tiles. My 3D printer isn't making perfectly straight edges but it works generally quite well. Here's the London one. This is a bit more like EastEnders, so you can zoom in and sing the theme tune! If you look closecally here, maybe put it on this projector, you can see visible seam lines, this one. This one isn't as good. In this case, my printer wasn't behaving perfectly right. I had to sand them down and be perfectly square. It's a relatively easy method. I like that it's unattended. You run the script, it makes a file, you press Print, and you go and do something else for 12 hours. There is a little bit of manual work involved - that sort of lining up portion, and making sure it's all correct, and the gluing stage is a bit tense, because once the glue is on, you've got 20 seconds or so of work time before it sets. If you get it wrong, you've got to peel it off and hope it looks all right again. It's a good start. It's not particularly durable. The ones you've seen here are used printing PLA. That's a cheap but not relatively durable plastic. I want to move up to ABS and other things too. There is a variety of plastics you can print it with you 3D printer stuff is brittle and hard to deal with. Let's move on to something that's much more durable, which is milling. If you're not familiar, milling is the opposite of 3D printing. 3D printing is additive, and you start with nothing, and it adds plastic to build the model up. Milling is subtractive. You start with a big block of metal, in my case, aluminium, because it is cheap and easy to work with, and then you have a mill which progressively carves out the shape with multiple passes in a similar way you build up layers with a 3D printer, you build up layers with a mill, smaller and smaller to build up a shape. Here, it's halfway down a copy of a mountain in California. There are a couple of problems with milling. First and foremost is, you've got a certain shape of milling bit. Often, it is circular. You can have a flat end or a round end. This one is a round-ended one. If you want to do small detail, you need a small bit. You need to be very, very small, but the smaller it is, the slower it goes, so you want to do a big rough pass with your nice big milling bit first, and then a medium pass with a half-sized one, and then a final pass with a small-sized one, and, in between these, you've got to have the machine come up and let you take the bit out, and put the new one in, and know the depth properly. It is a lot of manual work. Whereas 3D printing is unattended, milling is not. It's kind of unattended. You can sit there while it does each pass, about an hour or so per pass, but between those, you've got to get up, change the tool out, do that kind of stuff. There are machines that have automated tool changing. I would probably give some sort of limb to have access to one but they're very expensive. The one in my low carbon maker space in Oakland in California doesn't have any of that. The final result looks really good. You get small detailed models of their design. Things like the mountain and terrain come out really well. These are the six I've made so far. Given how long they are to make, it requires me to have an entire free evening to go and sit next to the machine and listen to a podcast while it whirrs away and hope it doesn't break anything. I have broken about ten milling bits at least making these six of them, because as you go smaller and smaller, they break really easily. You could be carve out a valley, and they pop off. The other thing with milling it's not as simple to feed a model into the machine. You have to take the 3D model, feed it into a CNC programme - I use Fusion from Autodesk - and then sit there and manually tweak the tool pass and tell it the strategies to use like, "I want you to do this flat pass first, and a pass with a milling bit." There's a good 30 minutes or so of me sitting down and planning out how the machine's going to work. Most of the routing is done for you but the stage, the high-level idea is yours. You sit there and go well, "Can I shave half an hour off the time by changing the strategy a little bit?" It's a lot more involved in general which is why they go slower. They are fast, the 3D printed ones because they're smaller, obviously. If you mill a one-metre thing, it will take almost forever on the machines I have access to, and it's attended work. You can't leave a CNC mill alone. They're giant spinning wheels of death. They're kind of dangerous to get near. You want to make sure they're attended if not going to ram themselves into the side of the piece and spray aluminium everywhere. The small features are also hard to mill. I have an example in my bag. You can see it later if you want. It shows very well. Like there's a little bit between two mountains that you just couldn't get to. There wasn't a bit small enough to mill that bit out. You lose the features in the deep valleys which is a problem with anything with mountains in it. CNC mills are one of the most expensive things I'm going to refer to in this presentation. The entry-level model is like £10,000, and, also, you have to have some light industrial space to put it in, and, also, you have to have some air extraction in that space, and, also, you then need all the tools as well. I would love to have one. I do not have the money or the space to do so, and so, thankfully, maker spaces solve the problem, but they don't have the budget or the expertise to run a CNC mill as well. It is often the big blocker to doing this as a project. I really hope in the next few years, we get more of a revelation in desktop, or smaller CNC mills. A few of them out now. We could make bigger steps in having smaller, more accessible milling, this kind of stuff. But finally, everyone's favourite:  laser cutting. I think pretty much every maker space from here to Sydney has a laser cutter. They're incredibly popular and easy to use. I love the things. That's one of the reasons I then took to the laser cutter for this third project, because it's something that I can literally plan out an SVG file, send it to the laser. It's about 15 minutes to cut the pieces out without the gluing. This here is an example of one of those sort of profiles that's been cut by the laser. And I have a piece of software that simply takes the terrain data you want, you slice lines out of it in two dimensions, and, then for each of those lines, you take the ... of heights and turn them into side-on few of objects. That ends you up with 30 or 40 of those individual pieces. Obviously, I would cut a giant piece of plastic - this is an illustration of one of them. You pop all the pieces out, you glue them on to a nice rigid bed, and you end up with stuff like this. This is my first attempt, the wonderful Scotland. It's not great. I used clear acrylic. I didn't realise that, because it is clear, you can't see it! [Laughter]. It's kind of an obvious thing. It looks lovely when you shine a light from the back of it. The problem is Scotland is almost too big. When you're zoomed out that far, the height of the mountains is not that high relative to the size of the land mass. And so, I tried to exaggerate the height and say, make the mountains way higher, but it doesn't quite look right. I'm still working with this. I want a nice Scotland on the wall but it's taking a bit of work. What is easy is Hawaii, because it's giant and surrounded by sea. Various lines of Hawaii you can do this easily, because they are very, very high, ten to 12 thousand feet each, and you can drive from sea-level to 10,000 feet in an hour, it's ridiculous, and, also, they're quite small. They're only about ten or 15 miles on each side. So you get that nice ratio of height to depth. I also think things like the South island of New Zealand could be a good thing for this. There are a few other options as well. There are a few problems with this, though. The sort of presentation of this has a few flaws. First of all, you can't see it if you're looking straight at it because it has to be viewed from the side. You have to do them side on so, see emthis as you walk around the room. If you do them vertically, people of a certain height will never see the artwork. If you're short, great. If you're an average height, why are they a random grid on the wall it makes no sense? Other problems is I tried it with things that are sort of cuttout portions of landscapes but it needs things that are surrounded by flattening. - flat edges. Islands are perfect for this. And, of course, it is limited detail. This is much more of an artist ic interpretation than those other ones. It is very much going to show you the rough outline of how it looks. It's not really going to show you fine detail and the script takes a lot of little bit tress exaggerating peaks. - it multiplies everything to the power of two to push up the mountains and bring down the valleys. You can see those details more clearly. That's the secret of all of these. Everything I've showed you, the London model, the city models, everything has the height exaggerated because if you look at a normal scale model, it is really flat and boring. You have to have the exaggeration to make it seem interesting, see how you see it when you look out the window of an aeroplane, for example. So that's a brief rundown of the stuff. There are a few things next I want to work on. These projects all kind of are in progress, along with my other 3,000 hobbies, they get time-shared. One of the key things is I want to do more milling. There are 53 national parks remaining. I do not have 53 spare evenings in the near future! So I need to work out a way to do a less human-intensive version of that, whether it's doing them quicker, or whether it is somehow finding a milling machine with an automatic tool-changer and bargaining with someone for that. Laze er-cutting, I want to work - how do you make a nice defined coastline that still brings the mountains up to be obvious? I want to see the Great Glen in perfect detail while still seeing the shape of the land mass. That can be hard to do when the edges can be flat compared to the mountains around of it. .  Point clouds and LiDAR, 3D directly from the point cloud. What I've shown you here is taking the point loud, making it into a 2D height map and then having that into a model. That means is you lose undercuts, like buildings that have things underneath them, and, in London, like the gherkin would render as the top half and straight sides. You need to do it more for that. There are commercial solutions but I'm a cheap skate. Trying to find a way to make a script that parses point clouds directly to surfaces is my next interest. Maybe I can get a LiDAR scanner, . When I said the CNC mill was the second most expensive thing, LiDAR scanners are the most expensive thing. The entry models are like £20,000. I do not have that anywhere. It's one of those things, like as we get them, and they're used, like as a crucial component like self-driving cars, they come down in price a bit. If you're curious about more of this, some of the code to make 3D models is up on my GitHub. There are a few blog articles with some of the process of this as well, and there is a couple of videos of me making the process, and going through the big city models on my YouTube channel as well. About 20 minutes of me faffing around gluing things badly. Don't hate me for my bad gluing. That's painfully it. Thank you very much before. 
>> I had a question, more of an idea. I really liked the idea of laser cutting the edges, and then stacking them. That's really cool. I also understand you've got a problem for kind of looking directly at it. You wouldn't be able to see, right? So, what about maybe building your model and then putting it into a vacuum former? So this way, it would actually feel - you know, put a very thin sheet of plastic between all of your layers, basically, and cannot fill it. So this way be you would have like a completely filled model with shapes, so, wherever you look at it, you will still get a light refracting from it, and it would really pop, I think. 
>> Yes, that's a good idea, I think. The other thing is, I've tried casting those shapes into to get a negative of them. That's the way too. There's a lot of interpretations. This is only if you weeks old, like it's the most recent thing, it's like a good idea, I think.
>> Because, I think you could potentially just stick it in, and just press it down, and it might work. 
>> The wonder of that is you just pull the lever and it works.
>> Another thing is expanding foam? Do you think that could work? 
>> I haven't got any of that around.
>> It's a - 
>> It's really messy.
>> That's right, you need to do a lot of cutting. 
>> These are good ideas. Thank you.
>> Thank you. 
>> Any more? Do you want to throw it over there? Too much? 
FLOOR:  Have you seen the Polish map of Scotland? 
>> The what, sorry? No is the answer. 
FLOOR:  So, about an hour south of Edinburgh, near Peebles there is what claims to be the largest terrain relief map called the Polish map of Scotland, or Map of Scotland, and it's made of concrete, and it's 10x vertically, like exaggerated, basically, but it's probably as big as this tent, if not bigger, it's next to a country home, but it's really cool. 
>> That sounds amazing. That's going on my list to go and see. Thank you very much. Over here? One more? One more question, okay. 
FLOOR:  It was just about your milling, whether you've considered milling perhaps wax or much softer materials which you could potentially make a wax cast, or something like that? 
>> In terms of increasing the speed, I was looking at literally milling machining wax, casting that, and then casting it into a resin. The problem is I like having aluminium as the result, and I don't have the ability to forge or cast metals, and, so it definitely will be a way of increasing speed and making nice resin versions. I'm not sure I can get the same aluminium, like machine effect. 
FLOOR:  Is it specifically aluminium or you want a harder metal? 
>> The softer the metal, the faster it is. Bronze or aluminium is quicker. You can mill iron, I guess! 
>> . 
FLOOR:  Bronze is something you could potentially cast. 
>> I haven't done the milling for a couple of months now. I lost access to the machine a while ago and got back to a different machine. I need to start on the new machine, basically. 
FLOOR:  Thank you. 
>> Cool. One more question at the back? Well done. 
FLOOR:  The scan that you did of this site, that looked like it was done optically rather than LiDAR, as in, was that a camera? 
>> Because it is not my scan, it is somebody else's scan. I've blanked the name temporarily? 
FLOOR:  I've done work using open drone map and it looked similar to that. You take video images, and it stitches them. I wondered if that was done the same way? 
>> That was done using a professional LiDAR van. You can do what is called photogrammetry where you use the difference in the pictures to work out the shape of the terrain. That's cheaper because it's a camera, basically. It is also of less accurate, and doing the stink in 3D models takes forever. I have some photogrammetry in Oregon. It's possible but difficult. 
FLOOR:  Indeed, I did a local scan and a 12-hour render. 
>> In terms of throughput and accuracy, LiDAR is the thing - and also, it's being improved a lot too. Maybe photogrammetry is as well.
>>  Another question? 
>> The person who did the scan is right here. He's amazing. Please ask him questions. All right. 
>> I've got one. 
>> Go for it. 
FLOOR:  So, actually, could you make your own LiDAR with an old laser print or something like that mechanism for less than 20 grand? 
>> The laser isn't the hard part, it is the hard part. Shining lasers is easy. Measuring the time of flight is harder. There is decent entry-level like single-laser stuff, putting that on a gimble and mapping it, basically. The most basic laser range, and trying a cheap hackie version of it is my next project. Thank you very much. [Applause]. 