Deploying a LoRaWAN network by Alistair MacDonaldcan. 
>> Can you give a big round of applause to Alistair MacDonald. 
>> I hope you have had a good day so far and going well. I then spent five minutes looking for a knife in my mouth. I'm trying to lower the expectations of this talk! I'm trying to show you something. This is really boring. You press this, and ... - and ... ta-da! [Applause]. It's not very impressive, but this is actually going through, well, several. This will work over the sayings. Well, I say two kilometres to five kilometres. It will work a lot further than your average Wi-Fi signal. It can't transmit much data. It's called LoRaWAN - with low-powered wide-area network and basically used for connecting the Internet of Things together. If you want to know about other options if we have time for questions, but this is a free and open one to use. Semtec is a company that's developed of the technology involved, and they lease it out. But most of the infrastructure that we are using is open source. In fact, LoRa is the encoding technology, and LoRaWAN moves things around the world. Where is the best place to stand? I will stand there. I should get my notes out!  I said I spent five minute looking for a knife that was in my mouth! So what is going on here? This the device. They're low-cost, you can get lots of different things. This is a Heltec module which cost me £12. It's a little bit rubbish, if I'm honest. It's got a round aTenja on there. The reason why is the antenna on the board didn't work so they modded and put it on and I don't want to jump ahead at the next talk but we will tell you how we had a similar system problem with the badges. It's a bit rubbish, and don't try to solder the pins on these because you will break it. This is the device which is over here. When I press the button, it goes out into the ether and picked up by stations. That's one we brought along to pick up. There's another five by the way. There are five stations all over this thing, and one is probably enough to cope with the entire site. So what is happening? This is sending out to the things that can be picked up. It then sends it across to a network server. We're using a service called the "things network", a tree, getting painful. It should be paid for by selling things. They're going having to look again at their business model. It's free and open. You can link your station into their server, and then everybody can use this. If you had one of these, under be using our station. You can feed memo ones as well. I should explain I got into this, because this is an interesting technology. I was talking to someone from one of the digital catapults and something came across his best about rolling these things out you could the technical network. I'm not speaking on behalf of the connected here but I'm not going to have a go because we are very nice. Nobody's producing devices for LoRaWAN because there's no network. Nobody's putting together a network because no-one's producing devices for LoRaWAN. They're saying let's put a network in place. A very good idea. The server bits, they bought a white-box version, in fact, they're now moving over to the things network as well, so all the stations that they have got are or soon will be will be feeding the things network. All my server does is receives the things and then sends back the time. You can't see it. It's got a little thing saying what the time is. That's come back from the server because it is two-way most of the time. Right, I'm going to go over here mostly to look at my notes. I said five minutes trying to find a knife in my mouth. What are the key features of this? It's called LoRaWAN because it is a long range. That's not so important to me. It means you don't need as many stations but if you're in a city, buildings get in the way, and stuff, so you do. Height is key. Near line of sight is best, and the higher it is, the better it is. If you can put a station high up, you're going to get more coverage. The thing I say about this, it's low power. You can have one of these in an embedded twice somewhere. It will call back once a day, or something, or when it is needed, uses next to no power. You can buy batteries for ten years. I'm a bit dubious and you can buy them for 20 years. You just put the thing to sleep. If you monitor river levelling, you get it to wake up every few hours, ping - you can have it only wakes up when there's an issue, or something. Car parking is another one that people are interested in because you can monitor when a car drives in, you send your signal out, say the car is parked. When it has gone, you send the signal out, and you don't need to run the radio for the rest of the time. What you're paying for that is it's only very small bits of data, depending on what error correction you use, this, the encoding. You can either send about 55 bytes up to 220, but that's only if you've got really good coverage. There's a thing called a spread factor which I will mention in a moment which affects it. Right, what else have we got? Reliability. It's not promised to be reliable. I have to say, we've done various bits of matching of where the signals should be good and bad, and, if you run a simulation, I will mention the software later on, it works really, really well. I've been going around with this. I don't know why I've not been arrested for something yet, but I'm going around the street with this looking at what is what and mapping out where the signal's good. There's definitely been people going outside at the camp doing it. In fact I might even have it on the next slide. Yes, this was Friday. This is Friday when we had the station up. This is from a service called TTN mapper. It is an app you run on your phone to log where you are, and then you have a station, and you just send a signal out. It works out how strong the signal was. It's a bit screwed because red is good. I find that in my head, especially with the station things, do I have a cursor? Yes, with the station things that blue is good. That was Friday. Some has clearly gone around. That's our station there, and I won't zoom in. It is a cached image. Someone is, "Oh, there's a station there." If it's you, say hi, I want to know. In if you have the other five stations anyway, come and say hello because I would love to know what you're doing. This was taken last night where it predicted most of the stations are or were. Three in one last night. Three were off. Also, somebody, I thought I took that slide out. Somebody is sending stuff out every few seconds as it were. Let's look at what is going on in this exact moment in time. This is the monitor I showed you of the station of the picture before, received 11,808 messages and only sent 84, because whoever is sending it is probably doing mapping, experimenting, I don't know, I don't care, it is data going through the network, very small bits. If I press my button, that's mine. Just off. Okay. And, because I'm not the strongest and quickest signal, this hasn't sensed the signal back. The signal that came back from here comes back other stations. Now we will try to do something silly. A bit of audience participation. This is going to be horribly wrong! The way the modulation works is a form of frequency-shifting coding. Instead of just going beep, it was rrrrrp kind of thing. We can trait why this is good by making the beeps and doing that sound. In a moment, we're going to do two things. I'm going to put my hands up to know when to turn the microphone off. I want you to go beepy noises. Go on! Good. I'm going to go beep-beep as well and see if I can hear mine over you. Right? Now I'm going to try doing the encoding. This we did try on a smaller scale and didn't work. I'm optimistic. Here we go. Beep. Hopefully some of the front will have heard my sound over the top of everybody else because it's noticeable. That's the way it works. You've got each channel on a station that do that. Slightly strange is the ninth channel on there which doesn't use that encoding. Sorry, outside the scope of this talk, if you want to know more about oddities, catch me afterwards. That is another map. This is output for month. What's the chap's name? V2DB, produced a software called mapping out radio footprints, and stuff. It's actually really useful, and I did that for here. As you can see, the entire campsite is covered, and this is how I knew I would be able to pick it up at the station, and these are accurate. I've been testing that at home. We've got Malcolm's in here who has been doing a lot of - well, I was going to say work or play. He's cycling around with his bicycle doing mapping. It is brilliant! That's what we were predicting. That's actually really useful. If you're wanting to put sites up, use this. Again, catch me afterwards. I will put my contact details on in our slide, and I will direct you to this, and you can get it to predict where things are going to go. It's really useful. Right. That's a blank slide. What is going wrong? Okay. I put the wrong one up. I don't care. I don't like slides anyway! What else was useful? I've done that. I'm going to skip over security because I disagree with a lot of people on the security. I don't think it's that secure. Some people do. The one thing I will say that it is encrypted twice.  It's encrypted between the device and the network, and between the device and the application which should be your application. There are a lot of reasons, really. When I press that button. It presses the data it's going to send and it encrypts it again, and it sends it out, picks it up, and it goes on to the network server. Every network server you feed, every network server that has received this message, encrypts it. It tries to decrypt it. If it can't, it decides it's not for it. If it can decrypt it, it says, "Ah, I understand what this is. This is useful. I should pass it on to the application I'm supposed to pass it on to." The original model was the network server wouldn't know what data was going through it, it would be relaying it through. It passes on that encrypted to the application server, that then decrypt it and you have your data. What really happens nowadays is that those two bits merged together and you got your own common API to get it to your actual server, so, for example, network by default, they use MPPT. It sends me an MPPT message. I'm then converting that into a JSON thing. Again, outside the scope of the talk, I can waffle on for hours. 
You've probably noticed. That's why we've got the two keys, it's more to type in. You need to a bit serrate and get on to the network. You can put in your device identifier which comes from the application. This is just a short number that will say the number of your device on the things. It's not unique but unique at that point in time, and you have two keys, the two keys for the encryption, and a counter which starts at zero. This is to stop stop what is called the replay attack. If somebody picks up your signal and can capture it, it can't send exactly the same thing again. I mean, it's say we're using it, I don't recommend it for unlocking doors, say you used it for unlocking a door, they can capture that and unlock the door. It has a counter which upgrades and counts up every time, and it's really annoying if you read set it because you've then got to go into the system. The counter will be zero again or something. I strongly recommend using over-the-air activation. Under the bonnet, it still needs those numbers. You need the unique identifier for the application. The unique identifier for the device. Those are globally unique that nobody else has. There is more stuff. I've got to type in more! Why would I want to to that? It is more secure. It sends that across to the station. It goes across to the network. The networks then encrypts, well, works out those keys, sends them back in a secure way, and you have the numbers on. Every time I reset that module, it will again send out that information again. The counter will start at zero, it is a secure encrypted traffic. So, yes, so one word of caution as well. If you're going to use a lot of devices, the byte order of the keys varies, and, on some systems, they even swap over depending whether it is the application key. If it's not activating, try reversing some keys around. Most sites have a reverse it round, and trial and error is the way of doing it. This is good, going nice and fast. Sort of set data limits. There are various bits of licensing around the world. In Europe, we run it on 868, only allowed to use one per cent of the spectrum. The things network has a restriction on top of that. They don't enforce it at the minute but they probably will soon. Work on the assumption that you are going to have to send, that you've got up to 30 seconds worth of air time a day total. So, if you use what is the frequency shift at FS12 which is the really reliable slow one, then it will take a long time to send. You're going only to get a small bit of data once or twice a day. If you use a lower value, then you can send a lot more frequently but it's less reliable. If you are further away from the thing, you will get less data through. So the other limits: hmm, yeah. As I said, I was working with a digital catapult and, when I started writing this talk about a month ago, there were no official sites up. We had brilliant coverage across Newcastle but we did this by basically going to friends with amateur radio masts and tall buildings saying can we put this in here? They said yeah, because officially, we needed to get people to sign pictures, sign papers. We need to get sign-off from IT people who were worried about security, and, to be honest, I totally understand that. It was next to impossible to do. So, things are getting better. Now, sites are going live. This is brilliant. My advice to you, if you're wanting to do something like that, try the softly-softly approach. Don't try go and get people to sign. Don't get people to sign their life away or agree access. People start thinking it is like a mobile network, I'm going to make thousands of pounds by leasing the site out. In five years' tile, you might get next to nothing. It is just, as I say, catch-22, and there may never be. I'm playing around with it. The other packet - this is an interesting issue we had. One building, we had two stations. We get on really well with the building manager. We had a station at the top of the building. But we were in the basement, and it was a bit iffy coming through six or seven floors. It did it in some places, but we installed another one in the basement. They were both on the same IP address and it started to go horribly wrong. Most of this infrastructure runs on UDP parsing - passing packets. There is a new version now which is a TCP connection, MCP and TCP, and a third one as well. My advice is it's more effort to use the newer version. In fact, ... I'm glad I made notes. Jack Kursing has made a nice thing based on the Semtex software, and that is the best thing to run on your stations. Since we've done that, we can actually connect two stations on the same IP address. The bug seems to be not in the thing, it appears to be on the network end. But I'm skipping over security. Well, I think I've gone through my list. I'm sorry if that is a bit his and miss but hopefully we will move on to questions now, and I'm expecting some good ones! Any questions? [Applause]. You're doing that out of sympathy! 
FLOOR:  You mentioned there are multiple speeds - 
>> I'm going to have to stand in front of the speaker because I can't hear you. [Feedback]. This is going to be a problem! 
FLOOR:  You mentioned there are different speeds of data [inaudible] mechanism for the radio part of it to back off ... 
>> No, it is in very small blocks. I mean, the stations broadcast the data but it's all managed through the - sorry. So, the stations are fairly dumb. When they receive the thing, they will send it out. When they receive something from the server, sorry, they will just send it out. The early packet forwarders, they received it and sent out blind and the timing is critical. What I didn't go into is the response that comes back, there are two windows. There's a one-second window, and there's a two-second window. The Things network uses a one-second window. A lot of sites ... 3G isn't quite fast enough. It needs to send it to the message, process it, sends it back to the station and sends it out. If you're feeding multiple networks then the last one that came back is in the buffer. It can only remember one. If you've got a lot going on from multiple networks, then one network could put their message over the top of another message, and you've lost a message. This has improved, and, in fact, on the thing I showed live, it actually said that it's been scheduled. That's because it has been ready to go. But I don't think there's any backing-off. Quite often, it is being used one way ... [inaudible]. 
FLOOR:  So I know in sort of the Oxford area area, there's a flood-mapping initiative. What is the use cases for LoRaWAN, or from and end-user use case deployment? 
>> That is a question. I go to a lot of meetings trying to sell the benefits of this thing. I depend to answer that depending on the audience. For example, when I go to ... network, it's like, "You can monitor your own and stuff" every time they monitor anything, the GSM, getting power and stuff to it - the car park example is one that a lot of City Council s like. I think - it's a bit of a wishy-washy answer but I don't really know what we can do with it. I wanted to get more stations up to get around that catch-22. I've got random ideas. I wanted to be monitoring the Tyne and we are Metro system. - Tyne and Wear Metro system. If I know the trains are running late, I could have an extra five minutes in bed! Wishy-washy answer to be decided, those are some examples. I've remembered one example, I mentioned before the workshops in the basement, we might be putting a doorbell on the back and using it. This is not the best technology for it, it's just [inaudible]. Has anybody not done a risk assessment for this! 
FLOOR:  You mentioned that you don't think LoRaWAN not secure. At what level are the security vulnerables and how could you hack this system?
>> I think this comes from a different perspective. I don't think it's horribly insecure, and, if you're sending boring census data back, you're putting it back into the Blake domain anyway, I wouldn't worry about it. It is not going to be a trivial thing but it's using the two keys putting your trust in other services. I can't go up and say I can mathematically prove this is secure. It is using ... key encryption. Basically, there's no public-private key or anything like that. If you can get hold of a twice, you can get keys out of it been stuff like that. It's not as secure as I would like it to be. I can't go up to someone and say this is secure. What I can say is if you're hosting a station on a network, I can't comment on the firmware on the device, bear in mind, it is like the Amazon Dash was hacked by sound, so I'm not saying it's impossible, but it's highly unlikely that the broadcast side is the way to break into that. It might open up a security hole, but from that point of view. It's encrypted, you don't know what it is. The only way it can be found out what it is when it arrives at the server when it tries to decrypt it. Fortunately, because the data's so small, you can feed multiple services, and the - more - so it won't even have to worry about feeding it. I was going to say something else then. Five minutes, knife, mouth! I shall finish answering that there, and, is that okay? 
FLOOR:  I'm new to LoRaWAN. I would like to set one up. Where do I start? 
>> That is a good question. Join up to the Things Network is my advice, thethingsnetwork.org. You might find a community around you. Certainly there are some in the north-east. You can message people, you can talk there. As for the equipment, I don't really know. The equipment we got, the curling stuff, it's expensive, and I wouldn't recommend that the most hobbyists get it, and there will be people better placed to answer. If you're talking about doing it seriously, don't penny pinch. If you pay twice as much for the same supplier that has 3.6 the coverage, when you consider getting the sites was the main problem, it would have been money well spent. Don't always go for the cheapest. If you want to experiment and get going, you shouldn't really but if you get an Arduino and a module, and set up a single-station site. If you're doing it down in a basement like we were, that's fine. You might need to start going down on abuse bit. It's fine. Mapper.org as well, you can see how people are doing testing as well. That's crowd-sourced. You can see the single-cell ones because they show up as red. All of the ones up here would have shown up as red when only the one thing was used. Thethingsnetwork.org. There's one over there. 
FLOOR:  I'm not sure what I'm going to ask about. But I've been reading recently about 5G networks, and, it occurred to me that it seems very much like a LoRaWAN architecture, so are there any parallels to draw, or is this going to be ... 
>> This is an interesting one. In fact, the reason why I was talking - we were talking about 5G and a lot of people see it as a halfway step to 5G. I totally disagree with that. It's a technology that stands on its own. I think it has a place after 5G comes along. I get very angry when people try to deliver firmware through this. I know why they're trying to do it, but that's the wrong technology. It has its place. The I see them as parallel technologies. This may or may not be a success. I hope it is. I do question some of the commercial ideas for these, especially considering it is an OS-based, unlicensed, so, this is competing with things like door-openers, and a lot of remote controls, and so very, very hard to run a guaranteed service on this with a service level. So consumer products using this in the near future. 5G maybe, but in terms of monitoring a switch or something, it's [inaudible]. I think I've been roped into the badge talk. After the badge talk, you'll be able to find me as well. Okay. [Applause]. 